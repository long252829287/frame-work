// ====================================
// 主题管理器 - Theme Manager
// ====================================

// 当前激活的主题 - 这个值将由CSS变量动态控制
$current-theme: 'stardew-valley' !default;

// 基于CSS变量的主题系统
// 所有主题变量都通过CSS变量来动态切换
:root {
  // 默认主题变量（星露谷主题）- 这些会被JavaScript动态覆盖
  --theme-primary-darkest: #5D4037;
  --theme-primary-dark: #8B4513;
  --theme-primary: #A0522D;
  --theme-primary-light: #CD853F;
  --theme-primary-lightest: #DEB887;

  --theme-secondary-darkest: #D2B48C;
  --theme-secondary-dark: #E6D3A3;
  --theme-secondary: #F4E4BC;
  --theme-secondary-light: #F5F5DC;
  --theme-secondary-lightest: #FAFAFA;

  --theme-accent-green-dark: #006400;
  --theme-accent-green: #228B22;
  --theme-accent-green-light: #32CD32;
  --theme-accent-green-bright: #90EE90;

  --theme-accent-orange-dark: #CC5500;
  --theme-accent-orange: #FF6B35;
  --theme-accent-orange-light: #FF8C42;
  --theme-accent-orange-bright: #FFA500;

  --theme-success: #228B22;
  --theme-warning: #FFD700;
  --theme-error: #DC143C;
  --theme-info: #4169E1;

  --theme-text-primary: #5D4037;
  --theme-text-secondary: #6D4C41;
  --theme-text-light: #8D6E63;
  --theme-text-inverse: #FFFFFF;
  --theme-text-disabled: #BCAAA4;

  --theme-border-primary: #8B4513;
  --theme-border-secondary: #E6D3A3;
  --theme-border-light: #F4E4BC;
  --theme-border-accent: #228B22;

  --theme-bg-primary: linear-gradient(135deg, #A0522D 0%, #CD853F 50%, #A0522D 100%);
  --theme-bg-secondary: linear-gradient(145deg, #F4E4BC 0%, #E6D3A3 100%);
  --theme-bg-card: linear-gradient(145deg, #F4E4BC 0%, #E6D3A3 100%);
  --theme-bg-overlay: rgba(139, 69, 19, 0.8);

  // 间距变量（这些通常在不同主题间保持一致，但也可以自定义）
  --theme-spacing-xs: 4px;
  --theme-spacing-sm: 8px;
  --theme-spacing-md: 12px;
  --theme-spacing-lg: 16px;
  --theme-spacing-xl: 20px;
  --theme-spacing-2xl: 24px;

  // 圆角变量
  --theme-radius-sm: 4px;
  --theme-radius-md: 6px;
  --theme-radius-lg: 8px;
  --theme-radius-xl: 12px;

  // 字体变量
  --theme-font-weight-normal: 400;
  --theme-font-weight-medium: 500;
  --theme-font-weight-semibold: 600;
  --theme-font-weight-bold: 700;

  // 过渡变量
  --theme-transition-fast: 0.15s ease;
  --theme-transition-normal: 0.2s ease;
  --theme-transition-slow: 0.3s ease;

  // Z-index变量
  --theme-z-dropdown: 1000;
  --theme-z-modal: 1050;
  --theme-z-tooltip: 1070;
  --theme-z-overlay: 10;

  // 阴影变量
  --theme-shadow-light: rgba(255, 255, 255, 0.3);
  --theme-shadow-dark: rgba(0, 0, 0, 0.3);
  --theme-shadow-inset: rgba(139, 69, 19, 0.1);
  --theme-shadow-card: rgba(0, 0, 0, 0.3);
}

// 工具函数 - 获取主题变量
// 这些函数现在直接返回CSS变量
@function theme-color($key) {
  @return var(--theme-#{$key});
}

@function theme-bg($key) {
  @return var(--theme-#{$key});
}

@function theme-btn($key) {
  @return var(--theme-#{$key});
}

@function theme-input($key) {
  @return var(--theme-#{$key});
}

@function theme-spacing($key) {
  @return var(--theme-spacing-#{$key});
}

@function theme-radius($key) {
  @return var(--theme-radius-#{$key});
}

@function theme-font-weight($key) {
  @return var(--theme-font-weight-#{$key});
}

@function theme-transition($key) {
  @return var(--theme-transition-#{$key});
}

@function theme-z($key) {
  @return var(--theme-z-#{$key});
}

@function theme-shadow($key) {
  @return var(--theme-shadow-#{$key});
}

// 通用主题混合器
// 这些混合器现在使用CSS变量，会自动跟随主题变化
@mixin theme-card {
  background: theme-bg('bg-card');
  border: 3px solid theme-color('border-primary');
  border-radius: theme-radius('xl');
  box-shadow:
    inset 0 2px 4px theme-shadow('light'),
    0 4px 12px theme-shadow('card');
  position: relative;

  // 纹理效果（仅在特定主题下显示）
  &::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    border-radius: theme-radius('xl');
    pointer-events: none;

    // 根据主题添加不同的纹理
    .theme-stardew-valley & {
      background-image: repeating-linear-gradient(
        90deg,
        transparent,
        transparent 2px,
        rgba(139, 69, 19, 0.1) 2px,
        rgba(139, 69, 19, 0.1) 4px
      );
    }

    .theme-modern & {
      background-image: linear-gradient(45deg,
        transparent 25%,
        rgba(0, 0, 0, 0.02) 25%,
        rgba(0, 0, 0, 0.02) 50%,
        transparent 50%,
        transparent 75%,
        rgba(0, 0, 0, 0.02) 75%);
      background-size: 20px 20px;
      opacity: 0.5;
    }

    .theme-dark & {
      background-image: radial-gradient(circle at 50% 50%,
        rgba(46, 160, 67, 0.1) 0%,
        transparent 50%);
    }

    .theme-classic & {
      background-image: repeating-linear-gradient(
        45deg,
        transparent,
        transparent 2px,
        rgba(0, 102, 204, 0.05) 2px,
        rgba(0, 102, 204, 0.05) 4px
      );
    }
  }
}

@mixin theme-button($type: 'default') {
  // 基础按钮样式
  color: theme-color('text-inverse');
  font-weight: theme-font-weight('semibold');
  border-radius: theme-radius('md');
  transition: all theme-transition('normal');
  border: 2px solid;

  @if $type == 'primary' {
    background: linear-gradient(145deg, theme-color('accent-green') 0%, theme-color('accent-green-light') 100%);
    border-color: theme-color('accent-green-dark');

    &:hover {
      background: linear-gradient(145deg, theme-color('accent-green-light') 0%, theme-color('accent-green') 100%);
      border-color: theme-color('accent-green');
      transform: translateY(-1px);
      box-shadow: 0 3px 8px theme-shadow('dark');
    }
  } @else if $type == 'secondary' {
    background: linear-gradient(145deg, theme-color('accent-orange') 0%, theme-color('accent-orange-light') 100%);
    border-color: theme-color('accent-orange-dark');

    &:hover {
      background: linear-gradient(145deg, theme-color('accent-orange-light') 0%, theme-color('accent-orange') 100%);
      border-color: theme-color('accent-orange');
      transform: translateY(-1px);
      box-shadow: 0 3px 8px theme-shadow('dark');
    }
  } @else {
    background: theme-bg('bg-secondary');
    border-color: theme-color('border-primary');

    &:hover {
      background: linear-gradient(145deg, theme-color('secondary-dark') 0%, theme-color('secondary') 100%);
      border-color: theme-color('accent-green');
      transform: translateY(-1px);
      box-shadow: 0 3px 8px theme-shadow('dark');
    }
  }
}

@mixin theme-input {
  background: theme-bg('bg-secondary');
  border: 2px solid theme-color('border-primary');
  border-radius: theme-radius('md');
  box-shadow: inset 0 2px 4px theme-shadow('inset');
  color: theme-color('text-primary');
  font-weight: theme-font-weight('medium');

  &:focus {
    border-color: theme-color('accent-green');
    box-shadow:
      inset 0 2px 4px theme-shadow('inset'),
      0 0 0 2px rgba(34, 139, 34, 0.2);
  }
}

@mixin theme-texture-bg {
  &::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    pointer-events: none;
    z-index: 0;

    // 根据主题应用不同的纹理
    .theme-stardew-valley & {
      background-image: radial-gradient(circle at 25% 25%, rgba(255, 255, 255, 0.1) 2px, transparent 2px),
                        radial-gradient(circle at 75% 75%, rgba(0, 0, 0, 0.1) 1px, transparent 1px);
      background-size: 40px 40px;
    }

    .theme-modern & {
      background-image: linear-gradient(rgba(0,0,0,0.03) 1px, transparent 1px),
                        linear-gradient(90deg, rgba(0,0,0,0.03) 1px, transparent 1px);
      background-size: 20px 20px;
      opacity: 0.5;
    }

    .theme-dark & {
      background-image: linear-gradient(90deg, transparent 24px, rgba(46, 160, 67, 0.05) 25px, rgba(46, 160, 67, 0.05) 26px, transparent 27px, transparent 74px, rgba(46, 160, 67, 0.05) 75px, rgba(46, 160, 67, 0.05) 76px, transparent 77px),
                        linear-gradient(transparent 24px, rgba(46, 160, 67, 0.05) 25px, rgba(46, 160, 67, 0.05) 26px, transparent 27px, transparent 74px, rgba(46, 160, 67, 0.05) 75px, rgba(46, 160, 67, 0.05) 76px, transparent 77px);
      background-size: 100px 100px;
      opacity: 0.3;
    }

    .theme-classic & {
      background-image: linear-gradient(rgba(0, 102, 204, 0.1) 1px, transparent 1px),
                        linear-gradient(90deg, rgba(0, 102, 204, 0.1) 1px, transparent 1px);
      background-size: 30px 30px;
      opacity: 0.3;
    }
  }
}

// 导出常用变量作为SCSS变量，以便在需要时使用
$font-weight-normal: var(--theme-font-weight-normal);
$font-weight-medium: var(--theme-font-weight-medium);
$font-weight-semibold: var(--theme-font-weight-semibold);
$font-weight-bold: var(--theme-font-weight-bold);

$transition-fast: var(--theme-transition-fast);
$transition-normal: var(--theme-transition-normal);
$transition-slow: var(--theme-transition-slow);

$z-dropdown: var(--theme-z-dropdown);
$z-modal: var(--theme-z-modal);
$z-tooltip: var(--theme-z-tooltip);
$z-overlay: var(--theme-z-overlay);

$shadow-light: var(--theme-shadow-light);
$shadow-dark: var(--theme-shadow-dark);
$shadow-inset: var(--theme-shadow-inset);
$shadow-card: var(--theme-shadow-card);

// 滑块变量
$slider-track: var(--theme-primary);
$slider-fill: var(--theme-accent-green);
$slider-thumb: var(--theme-secondary-lightest);